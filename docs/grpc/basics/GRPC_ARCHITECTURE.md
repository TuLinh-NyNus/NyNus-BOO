# gRPC Architecture - NyNus Exam Bank System (Consolidated)

**Kiáº¿n trÃºc toÃ n diá»‡n cá»§a há»‡ thá»‘ng gRPC vá»›i diagrams vÃ  sequences**

---

## ğŸ“‹ Má»¥c Lá»¥c

1. [System Overview](#system-overview)
2. [Dual Protocol Architecture](#dual-protocol-architecture)
3. [Proto Package Structure](#proto-package-structure)
4. [Service Dependency Graph](#service-dependency-graph)
5. [Code Generation Flow](#code-generation-flow)
6. [Request/Response Flow](#requestresponse-flow)
7. [Data Type Mapping](#data-type-mapping)
8. [Security Architecture](#security-architecture)
9. [Scalability Architecture](#scalability-architecture)
10. [Monitoring & Observability](#monitoring--observability)

---

## System Overview

### 1.1 Dual Protocol Architecture

NyNus sá»­ dá»¥ng **dual protocol system** Ä‘á»ƒ tá»‘i Æ°u hÃ³a communication:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EXAM BANK SYSTEM                                     â”‚
â”‚                     Protocol Buffers Architecture                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             FRONTEND LAYER                                   â”‚
â”‚                         (TypeScript / Next.js)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   React      â”‚  â”‚   Services   â”‚  â”‚   Hooks      â”‚  â”‚   Context    â”‚   â”‚
â”‚  â”‚  Components  â”‚â”€â”€â–¶â”‚   Layer      â”‚â”€â”€â–¶â”‚   Layer      â”‚â”€â”€â–¶â”‚   Providers  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                  â”‚                  â”‚                  â”‚           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                    â”‚                                          â”‚
â”‚                                    â–¼                                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚         â”‚        gRPC-Web Client (Generated Code)         â”‚                 â”‚
â”‚         â”‚  - UserServiceClient                             â”‚                 â”‚
â”‚         â”‚  - QuestionServiceClient                         â”‚                 â”‚
â”‚         â”‚  - ExamServiceClient                             â”‚                 â”‚
â”‚         â”‚  - AdminServiceClient                            â”‚                 â”‚
â”‚         â”‚  + 14 more clients...                            â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                    â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   gRPC-Web Protocol     â”‚
                        â”‚   (HTTP/1.1 + Proto)    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             BACKEND LAYER                                     â”‚
â”‚                              (Go / gRPC)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â”‚                                           â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚         â”‚          gRPC Gateway (HTTPâ†’gRPC Proxy)           â”‚                â”‚
â”‚         â”‚  - REST API endpoints                             â”‚                â”‚
â”‚         â”‚  - JSON â†” Protobuf conversion                    â”‚                â”‚
â”‚         â”‚  - HTTP annotations support                       â”‚                â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                    â”‚                                           â”‚
â”‚                                    â–¼                                           â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚         â”‚         gRPC Server (Service Layer)             â”‚                  â”‚
â”‚         â”‚                                                  â”‚                  â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚                  â”‚
â”‚         â”‚  â”‚  UserService    â”‚  â”‚ QuestionService â”‚      â”‚                  â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                  â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚                  â”‚
â”‚         â”‚  â”‚   ExamService   â”‚  â”‚  AdminService   â”‚      â”‚                  â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                  â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚                  â”‚
â”‚         â”‚  â”‚ LibraryService  â”‚  â”‚ AnalyticsServiceâ”‚      â”‚                  â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                  â”‚
â”‚         â”‚           + 12 more services...                 â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                    â”‚                                           â”‚
â”‚                                    â–¼                                           â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚         â”‚           7-Layer Interceptor Chain             â”‚                  â”‚
â”‚         â”‚  1. Rate Limit â†’ 2. CSRF â†’ 3. Auth â†’ 4. Sess   â”‚                  â”‚
â”‚         â”‚  5. Role/Level â†’ 6. Resource Prot â†’ 7. Audit   â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                    â”‚                                           â”‚
â”‚                                    â–¼                                           â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚         â”‚          Data Access Layer                       â”‚                  â”‚
â”‚         â”‚  - PostgreSQL                                    â”‚                  â”‚
â”‚         â”‚  - Redis Cache                                   â”‚                  â”‚
â”‚         â”‚  - OpenSearch                                    â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Why Dual Protocol?

**gRPC-Web (Frontend â†” Backend)**:
- âœ… Browser compatibility (HTTP/1.1)
- âœ… JSON support for debugging
- âœ… CORS handling built-in
- âœ… Works with existing HTTP infrastructure

**Pure gRPC (Backend Internal)**:
- âœ… High performance (HTTP/2 + binary)
- âœ… Bi-directional streaming
- âœ… Multiplexing
- âœ… Lower latency

### 1.3 Request Flow Sequence

```
Frontend (Next.js)
    â†“ 1. User clicks action
React Component
    â†“ 2. Call gRPC service client
gRPC-Web Client
    â†“ 3. Serialize to Protobuf binary
HTTP/1.1 POST Request (Port 8080)
    â†“ 4. Include metadata (Authorization, CSRF)
HTTP Gateway
    â†“ 5. Transcode HTTP/1.1 â†’ HTTP/2
    â†“ 6. Convert Protobuf â† JSON
gRPC Server (Port 50051)
    â†“ 7. 7-Layer Interceptor Chain
    â”œâ”€ RateLimitInterceptor
    â”œâ”€ CSRFInterceptor
    â”œâ”€ AuthInterceptor
    â”œâ”€ SessionInterceptor
    â”œâ”€ RoleLevelInterceptor
    â”œâ”€ ResourceProtectionInterceptor
    â””â”€ AuditLogInterceptor
    â†“ 8. Execute RPC method
gRPC Service Handler
    â†“ 9. Business logic + Database query
Database (PostgreSQL)
    â†“ 10. Return data
gRPC Service Handler
    â†“ 11. Build response message
gRPC Server
    â†“ 12. Serialize to Protobuf binary
HTTP Gateway
    â†“ 13. Transcode HTTP/2 â†’ HTTP/1.1
    â†“ 14. Convert JSON â† Protobuf
Frontend
    â†“ 15. Deserialize response
React Component
    â†“ 16. Update UI state
Browser
    âœ“ User sees result
```

---

## Dual Protocol Architecture

### Architecture Overview

Xem [System Overview](#system-overview) á»Ÿ trÃªn.

### Why Dual Protocol?

Xem [1.2 Why Dual Protocol?](#12-why-dual-protocol)

---

## Proto Package Structure

```
packages/proto/
â”‚
â”œâ”€â”€ common/                           â† Shared definitions (Layer 0)
â”‚   â””â”€â”€ common.proto
â”‚       â”œâ”€â”€ Response
â”‚       â”œâ”€â”€ PaginationRequest
â”‚       â”œâ”€â”€ PaginationResponse
â”‚       â”œâ”€â”€ UserRole enum
â”‚       â”œâ”€â”€ UserStatus enum
â”‚       â”œâ”€â”€ QuestionType enum
â”‚       â”œâ”€â”€ DifficultyLevel enum
â”‚       â””â”€â”€ QuestionStatus enum
â”‚
â”œâ”€â”€ google/                           â† Google API dependencies (Layer 0)
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ annotations.proto
â”‚       â””â”€â”€ http.proto
â”‚
â””â”€â”€ v1/                               â† API Version 1 (Layer 1)
    â”‚
    â”œâ”€â”€ Core Domain Services          â† Critical business logic
    â”‚   â”œâ”€â”€ user.proto
    â”‚   â”‚   â””â”€â”€ UserService (11 RPCs)
    â”‚   â”œâ”€â”€ question.proto
    â”‚   â”‚   â””â”€â”€ QuestionService (13 RPCs)
    â”‚   â”œâ”€â”€ exam.proto
    â”‚   â”‚   â””â”€â”€ ExamService (16 RPCs)
    â”‚   â””â”€â”€ admin.proto
    â”‚       â””â”€â”€ AdminService (10 RPCs)
    â”‚
    â”œâ”€â”€ Extended Services             â† Additional features
    â”‚   â”œâ”€â”€ library.proto (15 RPCs)
    â”‚   â”œâ”€â”€ book.proto (6 RPCs)
    â”‚   â”œâ”€â”€ analytics.proto (3 RPCs)
    â”‚   â””â”€â”€ search.proto (1 streaming RPC)
    â”‚
    â”œâ”€â”€ Communication Services        â† Messaging & notifications
    â”‚   â”œâ”€â”€ notification.proto (5 RPCs)
    â”‚   â”œâ”€â”€ newsletter.proto (3 RPCs)
    â”‚   â””â”€â”€ contact.proto (3 RPCs)
    â”‚
    â”œâ”€â”€ Support Services              â† User-facing features
    â”‚   â”œâ”€â”€ profile.proto (4 RPCs)
    â”‚   â”œâ”€â”€ blog.proto (8 RPCs)
    â”‚   â”œâ”€â”€ faq.proto (4 RPCs)
    â”‚   â””â”€â”€ tikz.proto (2 RPCs)
    â”‚
    â””â”€â”€ Utility Services              â† Internal tools
        â”œâ”€â”€ import.proto (3 RPCs)
        â”œâ”€â”€ mapcode.proto (4 RPCs)
        â””â”€â”€ question_filter.proto (4 RPCs)
```

---

## Service Dependency Graph

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    common    â”‚
                    â”‚    .proto    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     user     â”‚    â”‚   question   â”‚    â”‚     exam     â”‚
â”‚    .proto    â”‚    â”‚    .proto    â”‚    â”‚    .proto    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                    â”‚
       â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                             â”‚
       â–¼                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    admin     â”‚            â”‚   library    â”‚
â”‚    .proto    â”‚            â”‚    .proto    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ (imports user, profile, notification)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  profile     â”‚
â”‚    .proto    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Code Generation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          PROTO SOURCE FILES                          â”‚
â”‚                        (packages/proto/v1/*.proto)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  buf generate â”‚
                  â”‚   (v2 tool)   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                   â”‚
        â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   BACKEND (Go)    â”‚           â”‚ FRONTEND (TS/JS)  â”‚
â”‚ buf.gen.yaml      â”‚           â”‚buf.gen.frontend.  â”‚
â”‚                   â”‚           â”‚     yaml          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                               â”‚
        â”‚ Plugins:                      â”‚ Plugins:
        â”‚ â€¢ protoc-gen-go              â”‚ â€¢ protoc-gen-js
        â”‚ â€¢ protoc-gen-go-grpc         â”‚ â€¢ protoc-gen-grpc-web
        â”‚ â€¢ protoc-gen-grpc-gateway    â”‚
        â”‚                               â”‚
        â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Generated Go Files    â”‚   â”‚ Generated TypeScript    â”‚
â”‚                         â”‚   â”‚       Files             â”‚
â”‚ apps/backend/pkg/proto/ â”‚   â”‚ apps/frontend/src/      â”‚
â”‚ â”œâ”€â”€ common/             â”‚   â”‚      generated/         â”‚
â”‚ â”‚   â””â”€â”€ common.pb.go   â”‚   â”‚ â”œâ”€â”€ common_pb.js        â”‚
â”‚ â””â”€â”€ v1/                 â”‚   â”‚ â”œâ”€â”€ common_pb.d.ts      â”‚
â”‚     â”œâ”€â”€ user.pb.go      â”‚   â”‚ â”œâ”€â”€ v1/                 â”‚
â”‚     â”œâ”€â”€ user_grpc.pb.go â”‚   â”‚ â”‚   â”œâ”€â”€ user_pb.js      â”‚
â”‚     â”œâ”€â”€ user.pb.gw.go   â”‚   â”‚ â”‚   â”œâ”€â”€ user_pb.d.ts    â”‚
â”‚     â”œâ”€â”€ question.pb.go  â”‚   â”‚ â”‚   â””â”€â”€ UserService     â”‚
â”‚     â”œâ”€â”€ ...             â”‚   â”‚ â”‚       ClientPb.ts     â”‚
â”‚     â””â”€â”€ (54 files)      â”‚   â”‚ â””â”€â”€ ...                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                               â”‚
        â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Import in Backend     â”‚   â”‚   Import in Frontend    â”‚
â”‚                         â”‚   â”‚                         â”‚
â”‚ import pb "..../proto"  â”‚   â”‚ import { UserService    â”‚
â”‚                         â”‚   â”‚   Client } from         â”‚
â”‚ type UserService        â”‚   â”‚   '@/generated/...'     â”‚
â”‚   struct {              â”‚   â”‚                         â”‚
â”‚     ...                 â”‚   â”‚ const client = new      â”‚
â”‚   }                     â”‚   â”‚   UserServiceClient()   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Request/Response Flow

### Example: User Login Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser   â”‚                                          â”‚  Backend   â”‚
â”‚  (React)   â”‚                                          â”‚  (Go gRPC) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                                      â”‚
       â”‚ 1. User clicks "Login"                              â”‚
       â”‚    â†“                                                 â”‚
       â”‚ 2. Create LoginRequest                              â”‚
       â”‚    const req = new LoginRequest()                   â”‚
       â”‚    req.setEmail("user@example.com")                 â”‚
       â”‚    req.setPassword("password123")                   â”‚
       â”‚                                                      â”‚
       â”‚ 3. Call gRPC-Web client                             â”‚
       â”‚    userClient.login(req, metadata, callback)        â”‚
       â”‚                                                      â”‚
       â”‚ 4. Serialize to Protocol Buffers                    â”‚
       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
       â”‚    â”‚ Binary Protocol Buffer       â”‚                 â”‚
       â”‚    â”‚ Field 1 (email): ...         â”‚                 â”‚
       â”‚    â”‚ Field 2 (password): ...      â”‚                 â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
       â”‚                                                      â”‚
       â”‚ 5. Send HTTP POST with proto payload                â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚    POST /v1.UserService/Login                       â”‚
       â”‚    Content-Type: application/grpc-web+proto         â”‚
       â”‚                                                      â”‚
       â”‚                                          6. Receive request
       â”‚                                             â†“
       â”‚                                          7. Parse LoginRequest
       â”‚                                             from proto bytes
       â”‚                                             â†“
       â”‚                                          8. Execute Login()
       â”‚                                             â†“
       â”‚                                          9. Validate credentials
       â”‚                                             â†“
       â”‚                                          10. Generate tokens
       â”‚                                             â†“
       â”‚                                          11. Build LoginResponse
       â”‚                                             â†“
       â”‚                                          12. Serialize to proto
       â”‚ 13. Receive proto response                  â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚    HTTP 200 OK                                       â”‚
       â”‚    Content-Type: application/grpc-web+proto          â”‚
       â”‚                                                       â”‚
       â”‚ 14. Deserialize LoginResponse                        â”‚
       â”‚     â†“                                                 â”‚
       â”‚ 15. Extract data                                     â”‚
       â”‚     const user = response.getUser()                  â”‚
       â”‚     const token = response.getAccessToken()          â”‚
       â”‚     â†“                                                 â”‚
       â”‚ 16. Update UI state                                  â”‚
       â”‚     setUser(user)                                    â”‚
       â”‚     localStorage.setItem('token', token)             â”‚
       â”‚     â†“                                                 â”‚
       â”‚ 17. Navigate to dashboard                            â”‚
       â”‚                                                       â”‚
       â–¼                                                       â–¼
```

---

## Data Type Mapping

### Proto â†’ Go

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Proto Type       â”‚      Go Type         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ string              â”‚ string               â”‚
â”‚ int32               â”‚ int32                â”‚
â”‚ int64               â”‚ int64                â”‚
â”‚ bool                â”‚ bool                 â”‚
â”‚ bytes               â”‚ []byte               â”‚
â”‚ float               â”‚ float32              â”‚
â”‚ double              â”‚ float64              â”‚
â”‚ repeated T          â”‚ []T                  â”‚
â”‚ map<K,V>            â”‚ map[K]V              â”‚
â”‚ enum                â”‚ int32 (type alias)   â”‚
â”‚ message             â”‚ struct               â”‚
â”‚ google.protobuf.    â”‚ *timestamppb.        â”‚
â”‚   Timestamp         â”‚   Timestamp          â”‚
â”‚ oneof               â”‚ interface{} +        â”‚
â”‚                     â”‚ type assertion       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Proto â†’ TypeScript

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Proto Type       â”‚  TypeScript Type     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ string              â”‚ string               â”‚
â”‚ int32               â”‚ number               â”‚
â”‚ int64               â”‚ number               â”‚
â”‚ bool                â”‚ boolean              â”‚
â”‚ bytes               â”‚ Uint8Array           â”‚
â”‚ float               â”‚ number               â”‚
â”‚ double              â”‚ number               â”‚
â”‚ repeated T          â”‚ T[]                  â”‚
â”‚ map<K,V>            â”‚ Map<K,V>             â”‚
â”‚ enum                â”‚ enum (number)        â”‚
â”‚ message             â”‚ class                â”‚
â”‚ google.protobuf.    â”‚ Timestamp (class)    â”‚
â”‚   Timestamp         â”‚                      â”‚
â”‚ oneof               â”‚ union type           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SECURITY LAYERS                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: Transport Security (TLS)                                   â”‚
â”‚ â”œâ”€â”€ HTTPS/TLS 1.3 for all communications                            â”‚
â”‚ â”œâ”€â”€ Certificate pinning (optional)                                  â”‚
â”‚ â””â”€â”€ Perfect forward secrecy                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: Authentication (JWT)                                       â”‚
â”‚ â”œâ”€â”€ Access tokens (short-lived, 15 min)                             â”‚
â”‚ â”œâ”€â”€ Refresh tokens (long-lived, 7 days)                             â”‚
â”‚ â”œâ”€â”€ Session tokens (stateful)                                       â”‚
â”‚ â””â”€â”€ Metadata propagation (gRPC)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: Authorization (RBAC)                                       â”‚
â”‚ â”œâ”€â”€ Role-based access control                                       â”‚
â”‚ â”œâ”€â”€ Resource-level permissions                                      â”‚
â”‚ â””â”€â”€ Context-aware policies                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: Input Validation                                           â”‚
â”‚ â”œâ”€â”€ Proto schema validation (automatic)                             â”‚
â”‚ â”œâ”€â”€ Business rule validation                                        â”‚
â”‚ â”œâ”€â”€ SQL injection prevention (prepared statements)                  â”‚
â”‚ â””â”€â”€ XSS prevention (sanitization)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 5: Audit Logging                                              â”‚
â”‚ â”œâ”€â”€ All RPC calls logged                                            â”‚
â”‚ â”œâ”€â”€ User actions tracked                                            â”‚
â”‚ â”œâ”€â”€ Security events recorded                                        â”‚
â”‚ â””â”€â”€ Compliance reporting                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Xem SECURITY.md cho chi tiáº¿t Ä‘áº§y Ä‘á»§**

---

## Scalability Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   HORIZONTAL SCALING                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Load Balancer  â”‚
                    â”‚   (nginx/envoy) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                â”‚                â”‚
            â–¼                â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ gRPC Server  â”‚ â”‚ gRPC Server  â”‚ â”‚ gRPC Server  â”‚
    â”‚  Instance 1  â”‚ â”‚  Instance 2  â”‚ â”‚  Instance N  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                â”‚                â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  PostgreSQL  â”‚   â”‚  Redis Cache â”‚   â”‚  OpenSearch  â”‚
 â”‚  (Primary)   â”‚   â”‚ (Distributed)â”‚   â”‚  (Cluster)   â”‚
 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  PostgreSQL  â”‚
 â”‚  (Replicas)  â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Benefits:
â”œâ”€â”€ Stateless gRPC servers â†’ Easy horizontal scaling
â”œâ”€â”€ Load balancing â†’ High availability
â”œâ”€â”€ Service mesh ready â†’ Advanced traffic management
â””â”€â”€ Kubernetes native â†’ Container orchestration
```

---

## Monitoring & Observability

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OBSERVABILITY STACK                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

gRPC Services
     â”‚
     â”œâ”€â”€â”€ Metrics (Prometheus)
     â”‚    â”œâ”€â”€ Request count
     â”‚    â”œâ”€â”€ Latency (p50, p95, p99)
     â”‚    â”œâ”€â”€ Error rate
     â”‚    â””â”€â”€ Active connections
     â”‚
     â”œâ”€â”€â”€ Tracing (OpenTelemetry)
     â”‚    â”œâ”€â”€ Request flows
     â”‚    â”œâ”€â”€ Service dependencies
     â”‚    â”œâ”€â”€ Latency breakdown
     â”‚    â””â”€â”€ Error traces
     â”‚
     â””â”€â”€â”€ Logging (Structured)
          â”œâ”€â”€ Request/Response logs
          â”œâ”€â”€ Error logs
          â”œâ”€â”€ Audit logs
          â””â”€â”€ Security events

Visualization:
â”œâ”€â”€ Grafana dashboards
â”œâ”€â”€ Jaeger tracing UI
â””â”€â”€ ELK stack for logs
```

---

**Last Updated**: 2025-10-29  
**Version**: 1.0  
**Status**: âœ… Complete (Consolidated from 3 architecture files)

