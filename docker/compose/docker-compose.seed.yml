# Docker Compose configuration for database seeding
# Usage: docker-compose -f docker/compose/docker-compose.yml -f docker/compose/docker-compose.seed.yml run --rm seed

version: '3.8'

services:
  seed:
    image: node:20-alpine
    container_name: nynus-seed
    working_dir: /app
    environment:
      - DATABASE_URL=postgresql://exam_bank_user:exam_bank_password@postgres:5432/exam_bank_db?schema=public&sslmode=disable
    volumes:
      - ../../apps/frontend:/app
    networks:
      - exam_bank_network
    command: sh -c "
      echo '📦 Installing dependencies...' &&
      npm install -g pnpm &&
      pnpm install &&
      echo '⚙️  Generating Prisma Client...' &&
      pnpm prisma:generate &&
      echo '🌱 Running database seed...' &&
      pnpm db:seed &&
      echo '✅ Seed completed successfully!'
      "
    depends_on:
      - postgres

networks:
  exam_bank_network:
    name: compose_exam_bank_network
    external: true

